<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>WiFi SockServer</title>
<title>CMSIS-Driver Validation: WiFi SockServer</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="drv.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="printComponentTabs.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="stylsheetf" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 46px;">
  <td id="projectlogo"><img alt="Logo" src="keilarm.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">CMSIS-Driver Validation
   &#160;<span id="projectnumber">Version 1.3.0</span>
   </div>
   <div id="projectbrief">Driver Validation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<div id="DRVnav" class="tabs1">
    <ul class="tablist">
      <script type="text/javascript">
		<!--
		writeComponentTabs.call(this);
		//-->
      </script>
	  </ul>
</div>
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Usage&#160;and&#160;Description</span></a></li>
      <li><a href="modules.html"><span>Reference</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__wifi__sock__setup.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">WiFi SockServer<div class="ingroups"><a class="el" href="group__wifi__funcs.html">WiFi Validation</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<p>The <b>SockServer</b> is an application providing a set of services that the WiFi Driver Validation uses to test the Socket interface of the WiFi driver and is located in the <b>.\Tools\SockServer</b> subdirectory of the pack root directory. The SockServer runs several standard network services.</p>
<p>The following services are available by SockServer:</p>
<ul>
<li><b>Echo</b> service on port <span class="XML-Token">7</span>, TCP and UDP <br/>
 (two instances of TCP service, one instance of UDP service)</li>
<li><b>Discard</b> service on port <span class="XML-Token">9</span>, TCP and UDP <br/>
 (one instance of TCP service, one instance of UDP service)</li>
<li><b>Chargen</b> service on port <span class="XML-Token">19</span>, TCP and UDP <br/>
 (two instances of TCP service, one instance of UDP service)</li>
<li><b>Assistant</b> service on port <span class="XML-Token">5000</span> <br/>
 (helper service used to test WiFi sockets in server mode (socket accept functionality))</li>
<li><b>Telnet</b> service on port <span class="XML-Token">23</span> <br/>
 (SockServer status monitoring service)</li>
</ul>
<p>The <b>SockServer</b> also supports a telnet connection, which gives you information about received and sent data. This can help resolve driver problems when Wifi socket sending and receiving does not work well. For example, when the transfer test fails, you don't know if the <b>SocketSend</b> or <b>SocketRecv</b> functions have failed or both.</p>
<p>For the telnet connection, at the command prompt, type the following command or use another telnet client application. </p>
<div class="fragment"><div class="line">c:\&gt;telnet sockserver</div>
</div><!-- fragment --><p>The initial page opens: </p>
<div class="image">
<img src="SockServer.png" alt="SockServer.png"/>
<div class="caption">
Initial telnet connection</div></div>
<p> You can view the remote IP address, port number, receiving and transmitting counters with the <b>stat</b> command: </p>
<div class="image">
<img src="SockMonitor.png" alt="SockMonitor.png"/>
<div class="caption">
Status monitoring</div></div>
<p> Status monitor constantly updates the SockServer status on the screen. To stop the screen update, press any telnet client key.</p>
<p>WiFi drivers need to be tested in the wireless local area network. The testing environment contains the following equipment:</p>
<ul>
<li>WiFi router or Access Point with access to the Internet</li>
<li>board running <b>SockServer</b> application and connected to the same network with Ethernet cable</li>
<li>evaluation board with the WiFi module used for testing</li>
</ul>
<h2>Porting SockServer </h2>
<p>Currently, the <b>SockServer</b> application is available for the <b>MCB4300</b> and <b>MCBSTM32F400</b> evaluation boards. To create SockServer application for a different microcontroller, you need to do the following:</p>
<ol type="1">
<li>Create new network project in uVision</li>
<li>Select and configure the RTE Components:<ul>
<li><b>Network:Core</b> and configure the host name and pool size in <b>Net_Config.c</b> <div class="fragment"><div class="line"><span class="preprocessor">#define NET_HOST_NAME               &quot;SockServer&quot;</span></div>
<div class="line"><span class="preprocessor">#define NET_MEM_POOL_SIZE           16384</span></div>
</div><!-- fragment --></li>
<li><b>Network:Interface:Ethernet</b> and configure the MAC address in <b>Net_Config_ETH0.h</b> to avoid collisions <div class="fragment"><div class="line"><span class="preprocessor">#define ETH0_MAC_ADDR               &quot;1E-30-6C-A2-45-5A&quot;</span></div>
</div><!-- fragment --></li>
<li><b>Network:Socket:BSD</b> and configure number of sockets in <b>Net_Config_BSD.h</b> <div class="fragment"><div class="line"><span class="preprocessor">#define BSD_NUM_SOCKS               8</span></div>
<div class="line"><span class="preprocessor">#define BSD_SERVER_SOCKS            4</span></div>
</div><!-- fragment --></li>
<li><b>Network:Socket:TCP</b> and configure number of sockets in <b>Net_Config_TCP.h</b> <div class="fragment"><div class="line"><span class="preprocessor">#define TCP_NUM_SOCKS               9</span></div>
</div><!-- fragment --></li>
<li><b>Network:Socket:UDP</b> and configure number of sockets in <b>Net_Config_UDP.h</b> <div class="fragment"><div class="line"><span class="preprocessor">#define UDP_NUM_SOCKS               10</span></div>
</div><!-- fragment --></li>
<li><b>Network:Service:Telnet</b> server and disable authentication in <b>Net_Config_Telnet_Server.h</b> <div class="fragment"><div class="line"><span class="preprocessor">#define TELNET_SERVER_AUTH_ENABLE   0</span></div>
</div><!-- fragment --></li>
<li><b>CMSIS</b> <b>Driver:Ethernet/MAC/PHY</b>(API) depending on your hardware</li>
</ul>
</li>
<li>Configure device specific hardware:<ul>
<li>Configure the CMSIS Ethernet driver and other device specific components (clock system, I/O, ...) as required. Please consult your device's/board's documentation for more information.</li>
</ul>
</li>
<li>Copy <b>SockServer.c</b> and <b>SockServer.h</b> files and add the first to the project</li>
<li>Copy <b>Telnet_Server_UIF.c</b> and add it to the project</li>
<li>Add the code to start the services in <b>main.c</b> <div class="fragment"><div class="line"><span class="comment">// Application main thread</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> app_main (<span class="keywordtype">void</span> *argument) {</div>
<div class="line"> </div>
<div class="line">  netInitialize ();</div>
<div class="line">  osDelay (500);</div>
<div class="line"> </div>
<div class="line">  osThreadNew(DgramServer,   NULL, NULL);</div>
<div class="line">  osThreadNew(StreamServer,  NULL, NULL);</div>
<div class="line">  osThreadNew(TestAssistant, NULL, NULL);</div>
<div class="line">}</div>
</div><!-- fragment --></li>
<li>Increase default RTX stack size to 400 bytes in <b>RTX_Config.h</b> <div class="fragment"><div class="line"><span class="preprocessor">#define OS_STACK_SIZE           400</span></div>
</div><!-- fragment --></li>
<li>Set default global stack to 1024 bytes and heap to 6144 bytes in <b>startup</b> <b>file</b> <div class="fragment"><div class="line">Stack_Size      EQU     0x00000400</div>
<div class="line">Heap_Size       EQU     0x00001800</div>
</div><!-- fragment --> </li>
</ol>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Fri Oct 4 2019 14:13:04 for CMSIS-Driver Validation by ARM Ltd. All rights reserved.
	<!--
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 
	-->
	</li>
  </ul>
</div>
</body>
</html>
